<div class="container">

  <app-error [error]="error"></app-error>

  <app-loading [loading]="loading"></app-loading>

  <ng-container *ngIf="!loading && selectedChat">

    <div class="mt-4 mx-3 text-center flex-shrink-0">
      <button class="btn btn-sm btn-secondary" (click)="unSelectChat()">
        <fa-icon class="me-1" icon="arrow-left"></fa-icon>
        {{ 'CANDIDATE-OPP.CHAT-RETURN' | translate }}
      </button>
    </div>

    <div>
      {{ getChatHeaderTranslationKey(selectedChatType) | translate }}
    </div>

    <app-posts
      [chat]="selectedChat"
    >
    </app-posts>

    <div class="mt-4 mx-3 text-center flex-shrink-0">
      <button class="btn btn-sm btn-secondary" (click)="unSelectChat()">
        <fa-icon class="me-1" icon="arrow-left"></fa-icon>
        {{ 'CANDIDATE-OPP.CHAT-RETURN' | translate }}
      </button>
    </div>

  </ng-container>

  <ng-container *ngIf="!loading && !selectedChat">
    <div class="d-sm-flex justify-content-between">
      <div class="card-body">
        <app-error [error]="error"></app-error>

        <div class="row">

          <div class="mb-3 col-sm-12 col-md-4">
            <label class="col-form-label"><i class="fa-solid fa-map-location-dot"></i>
              {{ 'CANDIDATE-OPPS.TABLE.NAME' | translate }}</label>
            <div class="form-control-plaintext">
              {{selectedOpp?.jobOpp.name}}
            </div>
          </div>

          <div class="mb-3 col-sm-12 col-md-4">
            <label class="col-form-label"><i class="fa-solid fa-map-location-dot"></i>
              {{ 'CANDIDATE-OPPS.TABLE.STAGE' | translate }}</label>
            <div class="form-control-plaintext">
              {{getCandidateOpportunityStageTranslationKey(selectedOpp?.stage) | translate}}
            </div>
          </div>

          <div *ngIf="selectedOpp?.fileOfferLink" class="mb-3 col-sm-12 col-md-4">
            <label class="col-form-label"><i class="fa-solid fa-map-location-dot"></i>
              {{ 'CANDIDATE-OPPS.TABLE.OFFER' | translate }}</label>
            <div class="form-control-plaintext">
              <a class="link-secondary" target="_blank" [href]="selectedOpp.fileOfferLink">
                <i class="fa-solid fa-link"></i> {{selectedOpp.fileOfferName ? selectedOpp.fileOfferName : selectedOpp.fileOfferLink}}</a>
            </div>
          </div>

          <div *ngIf="selectedOpp?.jobOpp?.submissionList?.fileInterviewGuidanceLink" class="mb-3 col-sm-12 col-md-4">
            <label class="col-form-label"><i class="fa-solid fa-map-location-dot"></i>
              {{ 'CANDIDATE-OPPS.TABLE.INTERVIEW-GUIDANCE' | translate }}</label>
            <div class="form-control-plaintext">
              <a class="link-secondary" target="_blank"
                 [href]="selectedOpp?.jobOpp?.submissionList?.fileInterviewGuidanceLink">
                <i class="fa-solid fa-link"></i>
                {{selectedOpp?.jobOpp?.submissionList?.fileInterviewGuidanceName ?
                selectedOpp?.jobOpp?.submissionList?.fileInterviewGuidanceName :
                selectedOpp?.jobOpp?.submissionList?.fileInterviewGuidanceLink}}
              </a>
            </div>
          </div>

          <div>
            <label class="form-label" for="closingComments">
              {{ 'CANDIDATE-OPPS.TABLE.COMMENTS' | translate }}
            </label>
            <div class="col-12" id="closingComments"
                 [innerHtml]="selectedOpp?.closingCommentsForCandidate">
            </div>
          </div>

          <div>
            <label class="form-label" for="chats">
              {{ 'CANDIDATE-OPPS.TABLE.CHATS' | translate }}
            </label>
            <div id="chats">
              <div (click)="setSelectedChatType(JobChatType.CandidateProspect)">
                # {{ getChatHeaderTranslationKey(JobChatType.CandidateProspect) | translate }}
              </div>
              <div (click)="setSelectedChatType(JobChatType.CandidateRecruiting)">
                # {{ getChatHeaderTranslationKey(JobChatType.CandidateRecruiting) | translate }}
              </div>
              <div (click)="setSelectedChatType(JobChatType.AllJobCandidates)">
                # {{ getChatHeaderTranslationKey(JobChatType.AllJobCandidates) | translate }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="mt-4 mx-3 text-center flex-shrink-0">
        <button class="btn btn-sm btn-secondary" (click)="goBack()">
          <fa-icon class="me-1" icon="arrow-left"></fa-icon>
          {{ 'CANDIDATE-OPPS.OPP.RETURN' | translate }}
        </button>
      </div>
    </div>
  </ng-container>
</div>
