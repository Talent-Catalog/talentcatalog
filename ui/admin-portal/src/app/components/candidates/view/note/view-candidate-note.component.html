<!--
  ~ Copyright (c) 2024 Talent Catalog.
  ~
  ~ This program is free software: you can redistribute it and/or modify it under
  ~ the terms of the GNU Affero General Public License as published by the Free
  ~ Software Foundation, either version 3 of the License, or any later version.
  ~
  ~ This program is distributed in the hope that it will be useful, but WITHOUT
  ~ ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  ~ FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License
  ~ for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program. If not, see https://www.gnu.org/licenses/.
  -->

<tc-loading [loading]="loading"></tc-loading>

<tc-alert type="danger" *ngIf="error">
  <div><strong>{{error}}</strong></div>
</tc-alert>

<div class="d-flex justify-content-between mb-3 align-items-center" >
  <h3 class="m-0" *ngIf="!loading">
    Notes
  </h3>
  <tc-button *ngIf="editable"
             [type]="'solid'"
             [color]="'primary'"
             (onClick)="createCandidateNote()"
             [size]="'sm'"
             class="me-2"
  >
    <i class="fas fa-plus"></i>
  </tc-button>
</div>

<div *ngIf="!candidate.candidateNotes || candidate.candidateNotes.length == 0">
  <div class="row">
    <div class="col-sm-12">
      No notes entered
    </div>
  </div>
</div>

<div *ngFor="let candidateNote of candidate.candidateNotes; let i = index">
  <tc-card>
    <tc-card-header>
      <div class="me-2 note-title">
        {{ candidateNote.title }}
      </div>

      <div class="d-flex gap-2" style="flex-shrink: 0;">
        <tc-button *ngIf="candidateNote.comment"
                   (onClick)="showNote(candidateNote)"
                   [type]="'outline'"
                   [color]="'primary'"
                   [size]="'sm'">
          <i class="fas fa-ellipsis-h"></i>
        </tc-button>

        <tc-button *ngIf="editable"
                   (onClick)="editCandidateNote(candidateNote)"
                   [type]="'solid'"
                   [color]="'primary'"
                   [size]="'sm'">
          <i class="fas fa-edit"></i>
        </tc-button>
      </div>
    </tc-card-header>

    <div class="card-body">
      <div *ngIf="candidateNote.comment && candidateNote.showDetail">
        <div [innerHTML]="candidateNote.comment"></div>
        <hr/>
      </div>

      <div *ngIf="candidateNote">
        <app-updated-by *ngIf="candidateNote" [object]="candidateNote"></app-updated-by>
      </div>
    </div>
  </tc-card>
</div>



